{"ast":null,"code":"import API_BASE_URL from '../config/api';\n\n// Helper function to get auth token from localStorage\nconst getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Helper function to set auth token in localStorage\nconst setToken = token => {\n  localStorage.setItem('token', token);\n};\n\n// Helper function to remove auth token from localStorage\nconst removeToken = () => {\n  localStorage.removeItem('token');\n};\n\n// Helper function to get auth headers\nconst getAuthHeaders = () => {\n  const token = getToken();\n  return {\n    'Content-Type': 'application/json',\n    ...(token && {\n      Authorization: `Bearer ${token}`\n    })\n  };\n};\n\n// Register user\nexport const register = async userData => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/register`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        name: userData.name,\n        email: userData.email,\n        phoneNumber: userData.phoneNumber,\n        address: userData.address,\n        password: userData.password,\n        confirmpassword: userData.confirmPassword\n      })\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      // Handle validation errors (400 with errors object)\n      if (data.errors && typeof data.errors === 'object') {\n        const errorObj = {\n          type: 'validation',\n          errors: data.errors,\n          message: data.title || 'Validation failed'\n        };\n        throw errorObj;\n      }\n      // Handle simple error message (e.g., email exists)\n      throw new Error(data.message || 'Registration failed');\n    }\n\n    // Store token if registration is successful\n    if (data.token) {\n      setToken(data.token);\n    }\n    return {\n      success: true,\n      token: data.token,\n      message: data.data || 'Registration successful'\n    };\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Login user\nexport const login = async credentials => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(credentials)\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      throw new Error(data.message || 'Login failed');\n    }\n\n    // Store token if login is successful\n    if (data.data && data.data.token) {\n      setToken(data.data.token);\n    }\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get current user\nexport const getCurrentUser = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/me`, {\n      method: 'GET',\n      headers: getAuthHeaders()\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      // If token is invalid, remove it\n      if (response.status === 401) {\n        removeToken();\n      }\n      throw new Error(data.message || 'Failed to get user');\n    }\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Logout user\nexport const logout = () => {\n  removeToken();\n};\n\n// Check if user is authenticated\nexport const isAuthenticated = () => {\n  return !!getToken();\n};\n\n// Export as default object for easier imports\nconst authService = {\n  register,\n  login,\n  getCurrentUser,\n  logout,\n  isAuthenticated,\n  getToken,\n  setToken,\n  removeToken\n};\nexport default authService;","map":{"version":3,"names":["API_BASE_URL","getToken","localStorage","getItem","setToken","token","setItem","removeToken","removeItem","getAuthHeaders","Authorization","register","userData","response","fetch","method","headers","body","JSON","stringify","name","email","phoneNumber","address","password","confirmpassword","confirmPassword","data","json","ok","errors","errorObj","type","message","title","Error","success","error","login","credentials","getCurrentUser","status","logout","isAuthenticated","authService"],"sources":["/home/maher/AmiraWebsit/src/services/authService.js"],"sourcesContent":["import API_BASE_URL from '../config/api';\n\n// Helper function to get auth token from localStorage\nconst getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Helper function to set auth token in localStorage\nconst setToken = (token) => {\n  localStorage.setItem('token', token);\n};\n\n// Helper function to remove auth token from localStorage\nconst removeToken = () => {\n  localStorage.removeItem('token');\n};\n\n// Helper function to get auth headers\nconst getAuthHeaders = () => {\n  const token = getToken();\n  return {\n    'Content-Type': 'application/json',\n    ...(token && { Authorization: `Bearer ${token}` })\n  };\n};\n\n// Register user\nexport const register = async (userData) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/register`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify({\n        name: userData.name,\n        email: userData.email,\n        phoneNumber: userData.phoneNumber,\n        address: userData.address,\n        password: userData.password,\n        confirmpassword: userData.confirmPassword\n      })\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      // Handle validation errors (400 with errors object)\n      if (data.errors && typeof data.errors === 'object') {\n        const errorObj = {\n          type: 'validation',\n          errors: data.errors,\n          message: data.title || 'Validation failed'\n        };\n        throw errorObj;\n      }\n      // Handle simple error message (e.g., email exists)\n      throw new Error(data.message || 'Registration failed');\n    }\n\n    // Store token if registration is successful\n    if (data.token) {\n      setToken(data.token);\n    }\n\n    return {\n      success: true,\n      token: data.token,\n      message: data.data || 'Registration successful'\n    };\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Login user\nexport const login = async (credentials) => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/login`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(credentials)\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      throw new Error(data.message || 'Login failed');\n    }\n\n    // Store token if login is successful\n    if (data.data && data.data.token) {\n      setToken(data.data.token);\n    }\n\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get current user\nexport const getCurrentUser = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/me`, {\n      method: 'GET',\n      headers: getAuthHeaders()\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      // If token is invalid, remove it\n      if (response.status === 401) {\n        removeToken();\n      }\n      throw new Error(data.message || 'Failed to get user');\n    }\n\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Logout user\nexport const logout = () => {\n  removeToken();\n};\n\n// Check if user is authenticated\nexport const isAuthenticated = () => {\n  return !!getToken();\n};\n\n// Export as default object for easier imports\nconst authService = {\n  register,\n  login,\n  getCurrentUser,\n  logout,\n  isAuthenticated,\n  getToken,\n  setToken,\n  removeToken\n};\n\nexport default authService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}