{"ast":null,"code":"import API_BASE_URL from '../config/api';\n\n// Helper function to get auth token from localStorage\nconst getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Helper function to set auth token in localStorage\nconst setToken = token => {\n  localStorage.setItem('token', token);\n};\n\n// Helper function to remove auth token from localStorage\nconst removeToken = () => {\n  localStorage.removeItem('token');\n};\n\n// Helper function to get auth headers\nconst getAuthHeaders = () => {\n  const token = getToken();\n  return {\n    'Content-Type': 'application/json',\n    ...(token && {\n      Authorization: `Bearer ${token}`\n    })\n  };\n};\n\n// Helper function to get headers with language\nconst getHeadersWithLanguage = (language = 'en') => {\n  //console.log('###########################################');\n\n  const headers = {\n    'Content-Type': 'application/json'\n  };\n\n  // Only add Accept-Language header if language is Arabic\n  if (language === 'ar') {\n    headers['Accept-Language'] = 'ar-EG';\n  }\n  return headers;\n};\n\n// Register user\nexport const register = async (userData, language = 'en') => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/register`, {\n      method: 'POST',\n      headers: getHeadersWithLanguage(language),\n      body: JSON.stringify({\n        name: userData.name,\n        email: userData.email,\n        phoneNumber: userData.phoneNumber,\n        address: userData.address,\n        password: userData.password,\n        confirmpassword: userData.confirmPassword\n      })\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      // Handle validation errors (400 with errors object)\n      if (data.errors && typeof data.errors === 'object') {\n        const errorObj = {\n          type: 'validation',\n          errors: data.errors,\n          message: data.title || 'Validation failed'\n        };\n        throw errorObj;\n      }\n      // Handle simple error message (e.g., email exists)\n      throw new Error(data.message || 'Registration failed');\n    }\n\n    // Store token if registration is successful\n    if (data.token) {\n      setToken(data.token);\n    }\n    return {\n      success: true,\n      token: data.token,\n      message: data.data || 'Registration successful'\n    };\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Login user\nexport const login = async (credentials, language = 'en') => {\n  try {\n    var _data$data;\n    const response = await fetch(`${API_BASE_URL}/auth/login`, {\n      method: 'POST',\n      headers: getHeadersWithLanguage(language),\n      body: JSON.stringify(credentials)\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      // Return structured error so callers can handle validation or message\n      return {\n        success: false,\n        message: data.message || 'Login failed',\n        data\n      };\n    }\n\n    // Store token if login is successful\n    // token may be in different shapes depending on backend\n    const token = data.token || data.data && data.data.token || (data === null || data === void 0 ? void 0 : (_data$data = data.data) === null || _data$data === void 0 ? void 0 : _data$data.token) || null;\n    if (token) setToken(token);\n    return {\n      success: true,\n      data\n    };\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get current user\nexport const getCurrentUser = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/me`, {\n      method: 'GET',\n      headers: getAuthHeaders()\n    });\n    const data = await response.json();\n    if (!response.ok) {\n      // If token is invalid, remove it\n      if (response.status === 401) {\n        removeToken();\n      }\n      throw new Error(data.message || 'Failed to get user');\n    }\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Logout user\nexport const logout = () => {\n  removeToken();\n};\n\n// Check if user is authenticated\nexport const isAuthenticated = () => {\n  return !!getToken();\n};\n\n// Export as default object for easier imports\nconst authService = {\n  register,\n  login,\n  getCurrentUser,\n  logout,\n  isAuthenticated,\n  getToken,\n  setToken,\n  removeToken\n};\nexport default authService;","map":{"version":3,"names":["API_BASE_URL","getToken","localStorage","getItem","setToken","token","setItem","removeToken","removeItem","getAuthHeaders","Authorization","getHeadersWithLanguage","language","headers","register","userData","response","fetch","method","body","JSON","stringify","name","email","phoneNumber","address","password","confirmpassword","confirmPassword","data","json","ok","errors","errorObj","type","message","title","Error","success","error","login","credentials","_data$data","getCurrentUser","status","logout","isAuthenticated","authService"],"sources":["/home/maher/AmiraWebsit/src/services/authService.js"],"sourcesContent":["import API_BASE_URL from '../config/api';\n\n// Helper function to get auth token from localStorage\nconst getToken = () => {\n  return localStorage.getItem('token');\n};\n\n// Helper function to set auth token in localStorage\nconst setToken = (token) => {\n  localStorage.setItem('token', token);\n};\n\n// Helper function to remove auth token from localStorage\nconst removeToken = () => {\n  localStorage.removeItem('token');\n};\n\n// Helper function to get auth headers\nconst getAuthHeaders = () => {\n  const token = getToken();\n  return {\n    'Content-Type': 'application/json',\n    ...(token && { Authorization: `Bearer ${token}` })\n  };\n};\n\n// Helper function to get headers with language\nconst getHeadersWithLanguage = (language = 'en') => {\n\n    //console.log('###########################################');\n\n  const headers = {\n    'Content-Type': 'application/json'\n  };\n  \n  // Only add Accept-Language header if language is Arabic\n  if (language === 'ar') {\n    headers['Accept-Language'] = 'ar-EG';\n  }\n  \n  return headers;\n};\n\n// Register user\nexport const register = async (userData, language = 'en') => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/register`, {\n      method: 'POST',\n      headers: getHeadersWithLanguage(language),\n      body: JSON.stringify({\n        name: userData.name,\n        email: userData.email,\n        phoneNumber: userData.phoneNumber,\n        address: userData.address,\n        password: userData.password,\n        confirmpassword: userData.confirmPassword\n      })\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      // Handle validation errors (400 with errors object)\n      if (data.errors && typeof data.errors === 'object') {\n        const errorObj = {\n          type: 'validation',\n          errors: data.errors,\n          message: data.title || 'Validation failed'\n        };\n        throw errorObj;\n      }\n      // Handle simple error message (e.g., email exists)\n      throw new Error(data.message || 'Registration failed');\n    }\n\n    // Store token if registration is successful\n    if (data.token) {\n      setToken(data.token);\n    }\n\n    return {\n      success: true,\n      token: data.token,\n      message: data.data || 'Registration successful'\n    };\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Login user\nexport const login = async (credentials, language = 'en') => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/login`, {\n      method: 'POST',\n      headers: getHeadersWithLanguage(language),\n      body: JSON.stringify(credentials)\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      // Return structured error so callers can handle validation or message\n      return { success: false, message: data.message || 'Login failed', data };\n    }\n\n    // Store token if login is successful\n    // token may be in different shapes depending on backend\n    const token = data.token || (data.data && data.data.token) || (data?.data?.token) || null;\n    if (token) setToken(token);\n\n    return { success: true, data };\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Get current user\nexport const getCurrentUser = async () => {\n  try {\n    const response = await fetch(`${API_BASE_URL}/auth/me`, {\n      method: 'GET',\n      headers: getAuthHeaders()\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      // If token is invalid, remove it\n      if (response.status === 401) {\n        removeToken();\n      }\n      throw new Error(data.message || 'Failed to get user');\n    }\n\n    return data;\n  } catch (error) {\n    throw error;\n  }\n};\n\n// Logout user\nexport const logout = () => {\n  removeToken();\n};\n\n// Check if user is authenticated\nexport const isAuthenticated = () => {\n  return !!getToken();\n};\n\n// Export as default object for easier imports\nconst authService = {\n  register,\n  login,\n  getCurrentUser,\n  logout,\n  isAuthenticated,\n  getToken,\n  setToken,\n  removeToken\n};\n\nexport default authService;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}